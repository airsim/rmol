Name: @PACKAGE@
Summary: @PACKAGE_NAME@ is a Demand Simulator for Travel and Leisure oriented Users. It uses dynamic libraries for the modules, so as to be flexible in the implementation of new methods and algorithms for each of those modules.
Packager: Denis Arnaud <denis_arnaud@users.sourceforge.net>
%define version @VERSION@
%define release @RPM_RELEASE@
Version: %{version}
Release: %{release}
License: GPL
Vendor: Amadeus - MIT
Distribution: Research Software
Source: http://ncegcolnx14:8080/download/%{name}/%{name}-%{version}.tar.gz
Group: System Environment/Libraries
URL: http://ncegcolnx14:8080/latus
#Requires: gsl-devel >= 1.8
Requires: gsl >= 1.8

Prefix: %{_prefix}

BuildRoot: %{_tmppath}/%{name}-%{version}-buildroot
BuildRequires: gsl-devel >= 1.8
BuildRequires: autoconf >= 2.58, automake >= 1.8

Prereq: /sbin/install-info

%description 
LATUS is a Demand Simulator for Travel and Leisure oriented Users.
It uses dynamic libraries for the modules, so as to be flexible in the
implementation of new methods and algorithms for each of those modules.
 The modules are typically:
 * Demand Generator (latus)
 * User Choice Model (UCM)
 * Central Reservation System (CRS)
 * Travel Solutions Provider (TSP)
 * Availability Server (AVS)
 * Inventory (INV)
 * Revenue Management System (RMS). 

The providers (represented by an Inventory and a Revenue Management System) 
can be of any type (airline, hotel, car rental, cruise, insurance companies, 
etc.).

Install the latus package if you need a program to simulate how different
algorithms and methods best react to given demand scenarios.

%package devel
Summary: Static libraries and header files for LATUS development.
Group: Development/Libraries
Requires: %{name} = %{version}

%description devel

The latus-devel package contains the header files and static libraries
necessary for developing programs using the GSL (GNU Scientific
Library).

%package html-doc
Summary: HTML documentation for the @PACKAGE_NAME@ library
Group: System Environment/Libraries

%description html-doc
This package contains the documentation in the HTML format of the LATUS
binary. The documentation is the same as at the LATUS web page.

%prep
%setup -q

%build
%configure --enable-static --with-gsl-prefix=/nastools/gsl --with-docdir=%{_docdir}/%{name}-html-doc
make

%install
[ "$RPM_BUILD_ROOT" != "/" ] && rm -rf $RPM_BUILD_ROOT
make DESTDIR=$RPM_BUILD_ROOT install


# remove unpackaged files from the buildroot
rm -f $RPM_BUILD_ROOT%{_infodir}/dir
rm -rf $RPM_BUILD_ROOT%{_mandir}
rm -rf $RPM_BUILD_ROOT%{_sysconfdir}
rm -rf $RPM_BUILD_ROOT%{_libdir}/pkgconfig

latuscsuffix=`echo "%{_libdir}" | sed s,/usr/,,`
mv $RPM_BUILD_ROOT%{_bindir}/%{name}-config $RPM_BUILD_ROOT%{_bindir}/%{name}-config-$latuscsuffix
cat > $RPM_BUILD_ROOT%{_bindir}/%{name}-config << EOF
#!/bin/sh
if [ -e %{_bindir}/%{name}-config-lib64 ]; then
  exec %{_bindir}/%{name}-config-lib64 "\$@"
elif [ -e %{_bindir}/%{name}-config-* ]; then
  latuscfile="\`ls %{_bindir}/%{name}-config-* | head -n1\`"
  exec \$latuscfile "\$@" 
fi
EOF
chmod 755 $RPM_BUILD_ROOT%{_bindir}/%{name}-config


%post -p /sbin/ldconfig

%postun -p /sbin/ldconfig

%post devel
/sbin/install-info %{_infodir}/%{name}-ref.info.gz %{_infodir}/dir

%preun devel 
if [ "$1" = 0 ]; then
    /sbin/install-info --delete %{_infodir}/%{name}-ref.info.gz %{_infodir}/dir
fi

%clean
rm -rf $RPM_BUILD_ROOT

%files
%defattr(-,root,root)
%doc ABOUT-NLS AUTHORS COPYING ChangeLog INSTALL NEWS README TODO
%{_libdir}/*so.*

%files devel
%defattr(-,root,root)
%doc AUTHORS COPYING
%{_libdir}/*.la
%{_libdir}/*.a
%{_libdir}/*.so
%{_bindir}/%{name}-config*
%{_datadir}/aclocal/*
%{_includedir}/%{name}
%{_infodir}/*info*
# The pkgconfig file cannot be installed. I don't understand why. Help needed!
#%{_libdir}/pkgconfig/%{name}.pc
# If you find a way to install the man pages from within rpmbuild, don't
# hesitate!
#%{_mandir}/man*/*

%files html-doc
%doc %{_docdir}/%{name}-html-doc

%changelog
* Fri Mar 2 2007  Denis Arnaud <darnaud@amadeus.com>
- Initial spec file prepared
